# ESP32è·ç¦»è¿½è¸ªå™¨ - ç”µè„‘ç›‘æ§ç¨‹åº

## ğŸ“‹ åŠŸèƒ½è¯´æ˜

è¿™æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºåœ¨ç”µè„‘ä¸Šå®æ—¶ç›‘æ§ESP32å‘é€çš„è·ç¦»å’Œä¼ æ„Ÿå™¨æ•°æ®ã€‚

---

## ğŸ”§ å®‰è£…ä¾èµ–

### Windowsç³»ç»Ÿ

```powershell
# è¿›å…¥pc_monitorç›®å½•
cd pc_monitor

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# æˆ–è€…ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿ
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è¿æ¥ESP32

å°†ESP32é€šè¿‡USBçº¿è¿æ¥åˆ°ç”µè„‘ï¼Œç¡®è®¤COMå£å·ï¼ˆå¦‚COM3ï¼‰ã€‚

åœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­æŸ¥çœ‹ï¼š
```powershell
# PowerShellå‘½ä»¤
Get-PnpDevice -Class Ports
```

### 2. è¿è¡Œç›‘æ§ç¨‹åº

```powershell
# åŸºç¡€æ¨¡å¼ï¼ˆä»…æ˜¾ç¤ºæ•°æ®ï¼‰
python monitor.py

# æŒ‡å®šCOMå£
python monitor.py --port COM3

# æŒ‡å®šæ³¢ç‰¹ç‡
python monitor.py --port COM3 --baud 115200

# ä¿å­˜æ—¥å¿—
python monitor.py --port COM3 --log distance_log.txt

# å›¾å½¢ç•Œé¢æ¨¡å¼ï¼ˆå®æ—¶æ›²çº¿ï¼‰
python monitor.py --gui
```

---

## ğŸ“Š æ˜¾ç¤ºç•Œé¢

### å‘½ä»¤è¡Œæ¨¡å¼

```
========================================
ESP32è·ç¦»è¿½è¸ªå™¨ - å®æ—¶ç›‘æ§
========================================
ä¸²å£: COM3 | æ³¢ç‰¹ç‡: 115200
å¼€å§‹æ—¶é—´: 2025-12-14 15:30:25
========================================

[15:30:26] DISTANCE: 1.2m | RSSI: -52dBm | STATUS: VERY_CLOSE
           æ¸©åº¦: 25.3Â°C | æ¹¿åº¦: 45.2% | å…‰ç…§: 450 lux
           åŠ é€Ÿåº¦: X=0.12g Y=-0.05g Z=0.98g
           è¶…å£°æ³¢: 1.15m | äººä½“æ£€æµ‹: æ— 

[15:30:27] DISTANCE: 2.8m | RSSI: -65dBm | STATUS: NORMAL
           æ¸©åº¦: 25.3Â°C | æ¹¿åº¦: 45.1% | å…‰ç…§: 448 lux
           åŠ é€Ÿåº¦: X=0.11g Y=-0.06g Z=0.99g
           è¶…å£°æ³¢: 2.75m | äººä½“æ£€æµ‹: æ— 

[15:30:28] DISTANCE: 8.5m | RSSI: -78dBm | STATUS: WARNING âš ï¸
           æ¸©åº¦: 25.2Â°C | æ¹¿åº¦: 45.3% | å…‰ç…§: 445 lux
           åŠ é€Ÿåº¦: X=0.15g Y=-0.03g Z=0.97g
           è¶…å£°æ³¢: 8.45m | äººä½“æ£€æµ‹: æ£€æµ‹åˆ°

[15:30:29] DISTANCE: 15.3m | RSSI: -88dBm | STATUS: DANGER âŒ
           æ¸©åº¦: 25.1Â°C | æ¹¿åº¦: 45.2% | å…‰ç…§: 440 lux
           åŠ é€Ÿåº¦: X=0.18g Y=-0.02g Z=0.96g
           è¶…å£°æ³¢: N/A | äººä½“æ£€æµ‹: æ£€æµ‹åˆ°
           âš ï¸ è­¦å‘Šï¼šè·ç¦»è¶…è¿‡é˜ˆå€¼ï¼
```

### å›¾å½¢ç•Œé¢æ¨¡å¼ï¼ˆ--guiå‚æ•°ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESP32è·ç¦»è¿½è¸ªå™¨ - å®æ—¶ç›‘æ§                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                â”‚
â”‚  è·ç¦»æ›²çº¿å›¾ (å®æ—¶)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 15m â”¤                                â•±â”€   â”‚ â”‚
â”‚  â”‚ 10m â”¤                        â•±â”€â”€â”€â”€â”€â”€â•¯    â”‚ â”‚
â”‚  â”‚  5m â”¤        â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯           â”‚ â”‚
â”‚  â”‚  0m â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚      0s   5s   10s  15s  20s  25s  30s  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                â”‚
â”‚  å½“å‰çŠ¶æ€:                                      â”‚
â”‚  è·ç¦»: 15.3m    RSSI: -88dBm                   â”‚
â”‚  æ¸©åº¦: 25.1Â°C   æ¹¿åº¦: 45.2%                    â”‚
â”‚  å…‰ç…§: 440 lux  äººä½“: æ£€æµ‹åˆ°                    â”‚
â”‚                                                â”‚
â”‚  [ æš‚åœ ] [ æ¸…é™¤ ] [ ä¿å­˜æ—¥å¿— ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æ•°æ®æ ¼å¼

### ESP32å‘é€æ ¼å¼

ESP32é€šè¿‡ä¸²å£å‘é€JSONæ ¼å¼æ•°æ®ï¼š

```json
{
  "type": "data",
  "timestamp": 1702548626,
  "distance": 5.2,
  "rssi": -68,
  "status": "normal",
  "temperature": 25.3,
  "humidity": 45.2,
  "light": 450,
  "accel_x": 0.12,
  "accel_y": -0.05,
  "accel_z": 0.98,
  "ultrasonic": 5.15,
  "pir": false,
  "rfid_uid": "",
  "buzzer_on": false
}
```

### çŠ¶æ€ä»£ç 

| çŠ¶æ€å€¼ | è¯´æ˜ | è·ç¦»èŒƒå›´ |
|-------|------|---------|
| `very_close` | éå¸¸è¿‘ | 0-1m |
| `normal` | æ­£å¸¸ | 1-10m |
| `warning` | è­¦å‘Š | 10-15m |
| `danger` | å±é™© | >15m |

---

## ğŸ› ï¸ é«˜çº§åŠŸèƒ½

### æ•°æ®å¯¼å‡º

```powershell
# å¯¼å‡ºä¸ºCSVæ–‡ä»¶
python monitor.py --export csv --output data.csv

# å¯¼å‡ºä¸ºExcelæ–‡ä»¶
python monitor.py --export excel --output data.xlsx
```

CSVæ ¼å¼ï¼š
```csv
æ—¶é—´,è·ç¦»(m),RSSI(dBm),æ¸©åº¦(Â°C),æ¹¿åº¦(%),å…‰ç…§(lux),çŠ¶æ€
15:30:26,1.2,-52,25.3,45.2,450,very_close
15:30:27,2.8,-65,25.3,45.1,448,normal
15:30:28,8.5,-78,25.2,45.3,445,warning
```

### ç»Ÿè®¡åˆ†æ

```powershell
# æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
python monitor.py --stats

# è¾“å‡ºç¤ºä¾‹ï¼š
# å¹³å‡è·ç¦»: 5.8m
# æœ€å¤§è·ç¦»: 15.3m
# æœ€å°è·ç¦»: 1.2m
# å¹³å‡RSSI: -67dBm
# å¹³å‡æ¸©åº¦: 25.2Â°C
# æ•°æ®é‡‡æ ·ç‡: 10æ¬¡/ç§’
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šæ— æ³•æ‰“å¼€ä¸²å£

```
é”™è¯¯: Could not open port COM3
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ESP32å·²è¿æ¥
2. å…³é—­å…¶ä»–å ç”¨ä¸²å£çš„ç¨‹åºï¼ˆArduino IDEã€PuTTYç­‰ï¼‰
3. æ›´æ¢USBå£é‡è¯•
4. ç¡®è®¤é©±åŠ¨å·²å®‰è£…

### é—®é¢˜2ï¼šæ¥æ”¶ä¹±ç 

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤æ³¢ç‰¹ç‡ä¸€è‡´ï¼ˆé»˜è®¤115200ï¼‰
2. æŒ‰ESP32çš„RESETé”®é‡å¯
3. å°è¯•ä¸åŒæ³¢ç‰¹ç‡ï¼š`--baud 9600`

### é—®é¢˜3ï¼šæ²¡æœ‰æ•°æ®

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ESP32å›ºä»¶å·²çƒ§å½•
2. ç”¨Arduinoä¸²å£ç›‘è§†å™¨æµ‹è¯•æ˜¯å¦æœ‰è¾“å‡º
3. æ£€æŸ¥ESP32æ˜¯å¦æ­£å¸¸å·¥ä½œï¼ˆLEDæ˜¯å¦é—ªçƒï¼‰

---

## ğŸ“š Python API

å¦‚æœä½ æƒ³è‡ªå·±ç¼–å†™ç›‘æ§ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹APIï¼š

```python
from monitor import ESP32Monitor

# åˆ›å»ºç›‘æ§å™¨
monitor = ESP32Monitor(port='COM3', baudrate=115200)

# è¿æ¥
monitor.connect()

# è¯»å–æ•°æ®
while True:
    data = monitor.read_data()
    if data:
        print(f"è·ç¦»: {data['distance']}m")
        print(f"æ¸©åº¦: {data['temperature']}Â°C")
    
    time.sleep(0.1)

# æ–­å¼€è¿æ¥
monitor.disconnect()
```

---

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

ç¼–è¾‘ `config.json` æ–‡ä»¶è‡ªå®šä¹‰ç›‘æ§å‚æ•°ï¼š

```json
{
  "serial": {
    "port": "COM3",
    "baudrate": 115200,
    "timeout": 1
  },
  "display": {
    "refresh_rate": 10,
    "show_graph": true,
    "theme": "dark"
  },
  "alert": {
    "distance_threshold": 15,
    "enable_sound": true,
    "enable_notification": false
  },
  "logging": {
    "enable": true,
    "file": "esp32_log.txt",
    "level": "INFO"
  }
}
```

---

## ğŸ“¦ ä¾èµ–è¯´æ˜

- **pyserial**: ä¸²å£é€šä¿¡
- **matplotlib**: æ•°æ®å¯è§†åŒ–
- **pandas**: æ•°æ®åˆ†æ
- **tkinter**: å›¾å½¢ç•Œé¢ï¼ˆPythonè‡ªå¸¦ï¼‰

---

**ç›‘æ§æ„‰å¿«ï¼ğŸ“Š**
